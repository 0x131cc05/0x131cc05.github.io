<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"planarg.top","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="什么是线性规划 实际生活中有很多问题都是这样的形式：它们需要最大化或者最小化一个目标；它们通常面临资源、时间等多方面的限制。假如把这些问题的目标简化成一个线性的函数，把限制表示成一些线性的等式或者不等式，那么这些问题就可以被描述成线性规划问题。 ——2016国家集训队论文集  在线性规划中，我们有$n$个变量$x_1,x_2,\cdots, x_n$ 我们希望一个估价函数$f(x_1, x_2,x">
<meta property="og:type" content="article">
<meta property="og:title" content="线性规划">
<meta property="og:url" content="https://planarg.top/2019/04/28/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/index.html">
<meta property="og:site_name" content="PlanarG&#39;s blog">
<meta property="og:description" content="什么是线性规划 实际生活中有很多问题都是这样的形式：它们需要最大化或者最小化一个目标；它们通常面临资源、时间等多方面的限制。假如把这些问题的目标简化成一个线性的函数，把限制表示成一些线性的等式或者不等式，那么这些问题就可以被描述成线性规划问题。 ——2016国家集训队论文集  在线性规划中，我们有$n$个变量$x_1,x_2,\cdots, x_n$ 我们希望一个估价函数$f(x_1, x_2,x">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-04-28T12:40:20.000Z">
<meta property="article:modified_time" content="2020-06-25T09:06:56.045Z">
<meta property="article:author" content="PlanarG">
<meta property="article:tag" content="网络流">
<meta property="article:tag" content="计算几何">
<meta property="article:tag" content="半平面交">
<meta property="article:tag" content="线性规划">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://planarg.top/2019/04/28/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>线性规划 | PlanarG's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">PlanarG's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section">首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section">标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section">分类</a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/friends/" rel="section">友链</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section">归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://planarg.top/2019/04/28/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/77041874_p0_master12001.jpg">
      <meta itemprop="name" content="PlanarG">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PlanarG's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          线性规划
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-04-28 20:40:20" itemprop="dateCreated datePublished" datetime="2019-04-28T20:40:20+08:00">2019-04-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-06-25 17:06:56" itemprop="dateModified" datetime="2020-06-25T17:06:56+08:00">2020-06-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="什么是线性规划"><a href="#什么是线性规划" class="headerlink" title="什么是线性规划"></a>什么是线性规划</h1><blockquote>
<p>实际生活中有很多问题都是这样的形式：它们需要最大化或者最小化一个目标；它们通常面临资源、时间等多方面的限制。假如把这些问题的目标简化成一个线性的函数，把限制表示成一些线性的等式或者不等式，那么这些问题就可以被描述成线性规划问题。</p>
<p>——2016国家集训队论文集</p>
</blockquote>
<p>在线性规划中，我们有$n$个变量$x_1,x_2,\cdots, x_n$</p>
<p>我们希望一个估价函数$f(x_1, x_2,x_3,\cdots,x_n)$尽量大/小</p>
<p>同时我们希望这些变量能满足一些线性等式或者不等式$g(x_1,x_2,x_3,\cdots,x_n)$</p>
<p>那么这个过程就叫线性规划</p>
<h1 id="一些定义"><a href="#一些定义" class="headerlink" title="一些定义"></a>一些定义</h1><ul>
<li><strong>线性函数</strong></li>
</ul>
<p>我们定义函数$f(x_1,x_2,x_3,\cdots,x_n)$为线性函数当且仅当有</p>
<script type="math/tex; mode=display">
f(x_1,x_2,\cdots,x_n)=\sum_{i=1}^na_ix_i</script><p>其中$a_i$为实数常量，$x_i$为变量</p>
<ul>
<li><strong>线性等式</strong></li>
</ul>
<p>定义线性等式为$f(x_1,x_2,\cdots,x_n)=b$，其中$f$是线性函数，$b$是实数常量</p>
<ul>
<li><strong>线性不等式</strong></li>
</ul>
<p>定义线性不等式为$f(x_1,x_2,\cdots,x_n)\leq b$或者$f(x_1,x_2,\cdots,x_n)\geq b$，其中$f$是线性函数，$b$是实数常量</p>
<h1 id="标准型线性规划"><a href="#标准型线性规划" class="headerlink" title="标准型线性规划"></a>标准型线性规划</h1><p>标准型线性规划要求满足如下形式</p>
<p>最<strong>大</strong>化</p>
<script type="math/tex; mode=display">
\sum_{i=1}^nc_ix_i</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{j=1}^na_{ij}x_j&\leq b_i\quad\quad i=1,2,\cdots,m\\\
x_i&\geq 0 \quad\quad \ i=1,2,\cdots, n
\end{aligned}</script><ul>
<li>那么问题来了，如果某个限制不是$\sum a_ix_i\leq b$，而是$\sum a_ix_i\geq b$，怎么办？</li>
</ul>
<p>等式两边同时乘以一个负号，就可以变成小于等于</p>
<ul>
<li>那如果是要求估价函数最小呢？</li>
</ul>
<p>将所有的$c_i$取反，最后再将答案取反</p>
<ul>
<li>如果有一个限制是$\sum a_ix_i=b$怎么办？</li>
</ul>
<p>将其拆成两个限制，$\sum a_ix_i\geq b$以及$\sum a_ix_i\leq b$</p>
<ul>
<li>如果有一个变量$x$没有要求其$\geq 0$呢</li>
</ul>
<p>将其拆成两个变量$a,b$，令$x=a-b$，再令$a\geq 0,b\geq 0$即可</p>
<p>标准型还可以用矩阵表示</p>
<p>如果我们用$c$表示$c_i$构成的行向量，$A$为$a$构成的矩阵，那么它等价于</p>
<p>最大化</p>
<script type="math/tex; mode=display">
c^Tx</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
Ax\leq b\\
x\geq 0
\end{gathered}</script><p>其中$c^T$表示矩阵转置</p>
<p>注意这里的$\leq,\geq$代表每一维都小于等于/大于等于</p>
<h1 id="松弛型线性规划"><a href="#松弛型线性规划" class="headerlink" title="松弛型线性规划"></a>松弛型线性规划</h1><p>如果直接求解标准型线性规划，涉及到乘法不等式变号的问题，而且满足的是不等式也不太好做</p>
<p>我们把它转化一下</p>
<p>我们新引入$m$个变量（$m$是约束个数，$n$是未知数个数）</p>
<p>对于限制</p>
<script type="math/tex; mode=display">
\sum_{i=1}^na_ix_i\leq b,x_i\geq 0</script><p>我们利用一个新的变量$x_{i+n}$，可以将它变成</p>
<script type="math/tex; mode=display">
\begin{gathered}
b-\sum_{i=1}^na_ix_i=x_{i+n}\\ x_{i+n}\geq 0,x_i\geq 0
\end{gathered}</script><p>这样就可以将不等式转化为等式了</p>
<p>所以我们这样表示松弛型线性规划：</p>
<p>最大化</p>
<script type="math/tex; mode=display">
\sum_{i=1}^nc_ix_i</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{aligned}
x_{i+n}&=b_i-\sum_{j=1}^na_{ij}x_j\quad\quad i=1,2,\cdots,m\\
x_j&\geq 0,x_{i+n}\geq 0\quad\quad\ \ \ i=1,2,\cdots,m
\end{aligned}</script><p>我们将$x_i(i\leq n)$叫做<strong>非基变量</strong>，$x_{i+n}$叫做<strong>基变量</strong></p>
<p>可以看出，标准型线性规划可以很方便地转移成松弛型线性规划</p>
<h1 id="单纯形"><a href="#单纯形" class="headerlink" title="单纯形"></a>单纯形</h1><p>显然最终解所构成的区域一定是一个凸集，局部最优解只有一个</p>
<p>所以我们可以使用类似爬山算法的方法，每次往估价函数更优的那个方向爬，直到爬不动为止</p>
<p>我们首先来尝试构造一组基本解，即先满足所有约束，不管估价函数</p>
<p>如果所有的$b$都大于等于$0$，那么显然有一组解为所有的非基变量都为$0$，否则接下来会讲</p>
<p>我们将这个解进行“转轴”操作，使其往估价函数更优的那一方移动</p>
<h2 id="转轴操作"><a href="#转轴操作" class="headerlink" title="转轴操作"></a>转轴操作</h2><p>我们默认，任意时刻，非基变量的值都为$0$</p>
<p>一次转轴操作，等价于将一个基变量与一个非基变量<strong>交换位置</strong>，即基变量变成非基变量，非基变量变成基变量</p>
<p>我们假设选择了一个基变量$x_B$与一个非基变量$x_N$，现在要交换它们</p>
<p>原来的约束是这样的</p>
<script type="math/tex; mode=display">
x_B=b-\sum_{i=1}^na_ix_i</script><p>我们将$x_N$提出来，然后移项</p>
<script type="math/tex; mode=display">
\begin{gathered}
x_B=b-\sum_{i\not =N}a_ix_i-a_Nx_N\\
x_N=\frac{b-\sum_{i\not= N}a_ix_i-x_B}{a_N}
\end{gathered}</script><p>注意！此时的$x_B$变成了$0$，因为它从一个基变量变成了一个非基变量，而$x_N$的值变成了$\frac{b}{a_N}$</p>
<p>由于我们之前是<strong>交换</strong>基变量与非基变量，所以在等式中，$x_N$这一项的系数变成了$-\frac{1}{a_N}$，而其它项的系数分别除以了$a_N$</p>
<p>我们用这条新的等式代替原来的等式，然后再用这条等式去替换其它的约束以及估价函数</p>
<p>就像高斯消元一样，将其它式子带有$x_N$的项改为这个式子</p>
<p>所以转一次的时间复杂度为$O(nm)$</p>
<p>那么如何选择要进行操作的两个变量呢</p>
<p>显然我们必须满足条件：</p>
<ol>
<li>转完之后估价函数必须更优秀</li>
<li>转完之后等式右边的$b$不能小于$0$</li>
</ol>
<p>我们先考虑第一个条件</p>
<p>在转轴的过程中，$x_N$从原来的$0$变成了一个实数，它在一直变大，所以为了让答案更大，必须有$c_N&gt; 0$</p>
<p>否则当前已经是最优解，退出</p>
<p>接着考虑第二个条件</p>
<p>对于一个等式</p>
<script type="math/tex; mode=display">
x_{i+n}=b-\sum_{i=1}^na_ix_i</script><p>它限制了$x_N$的上界或者下界</p>
<p>如果$a_N\leq0$，那么它无法限制$x_N$的上界，答案为无穷大</p>
<p>否则$x_N$的上界为$\frac{b}{a_N}$</p>
<p>为了让转轴之后，其它的等式的常数都大于等于$0$</p>
<p>我们每次选择$\frac{b}{a_N}$最小的那一个进行转轴操作即可</p>
<hr>
<p>代码如下</p>
<p>注意<code>s[...][n + 1]</code>存的是$b$，也就是那个约束的基变量，其它位置存的是每一项的系数，第一维表示第几个约束</p>
<p>这里的系数算上了前面那个负号</p>
<p><code>c</code>是估价函数，<code>c[n + 1]</code>是这个估价函数当前的值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pivot</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="comment">// 转轴操作, x为未知数, y为第几个方程</span></span><br><span class="line">    <span class="keyword">double</span> tmp = s[y][x]; s[y][x] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n + <span class="number">1</span>;i++) s[y][i] /= -tmp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++) <span class="keyword">if</span> (i != y) &#123;</span><br><span class="line">        tmp = s[i][x], s[i][x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (tmp &lt;= eps &amp;&amp; tmp &gt;= -eps) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n + <span class="number">1</span>;j++) s[i][j] += tmp * s[y][j]; </span><br><span class="line">    &#125;</span><br><span class="line">    tmp = c[x], c[x] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n + <span class="number">1</span>;i++) c[i] += tmp * s[y][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">LP</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123; <span class="comment">// n为未知数的个数, m为方程数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> pos, cur;;pivot(pos, cur, n, m)) &#123;</span><br><span class="line">        <span class="keyword">double</span> tmp = <span class="number">1e100</span>; pos = cur = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="keyword">if</span> (c[i] &gt; eps) pos = i;</span><br><span class="line">        <span class="keyword">if</span> (!pos) <span class="keyword">return</span> c[n + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++) <span class="keyword">if</span> (s[i][pos] &lt; -eps) &#123;</span><br><span class="line">            <span class="keyword">double</span> now = s[i][n + <span class="number">1</span>] / -s[i][pos];</span><br><span class="line">            <span class="keyword">if</span> (now &lt; tmp) tmp = now, cur = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!cur) <span class="keyword">return</span> <span class="number">1e100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：<strong>线性规划的时间复杂度最坏情况下是指数级别的</strong></p>
<h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><p>我们来讨论一下当存在$b_i&lt;0$的时候该怎么做</p>
<p>显然这个时候我们之前选择的非基向量等于$0$的解就不满足条件了</p>
<p>我们随便找到一个$b&lt;0$的约束，比如是这个</p>
<script type="math/tex; mode=display">
x_{t+n}=b_t-\sum_{j=1}^na_{tj}x_j</script><p>我们从这个约束中，随便找到一个系数（注意算上前面那个负号）大于$0$的变量，假设是$x_B$</p>
<p>进行一次转轴操作，将$x_B$换成基变量，将$x_{t+n}$换成非基变量</p>
<script type="math/tex; mode=display">
x_B=\frac{b_t-\sum_{j\not =B}a_{tj}x_j-x_{t+n}}{a_{tB}}</script><p>由于之前我们要求了$x_B$的系数必须为正，也就是说$a_{tB}$为负</p>
<p>而$b_t$为负，那么转轴之后这个约束的$b$就变成正的了</p>
<p>如果我们找不到这样一个系数为正的非基变量，那么原线性规划一定无解</p>
<p>因为所有的变量都必须不小于$0$，因此这个约束的右边一定小于$0$，无解</p>
<p>注意这样转一次轴之后，虽然这个约束的$b$变成正的了，但是其它约束的$b$可能就变成负数了</p>
<p>但是没关系，我们有信仰，<code>while (1)</code>转轴就可以了，直到所有约束的$b$都变成正数</p>
<p>即使这样时间复杂度是玄学的</p>
<p>代码如下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">233</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> r = <span class="number">0</span>, c = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;++i) <span class="keyword">if</span>(a[i][n + <span class="number">1</span>] &lt; <span class="number">0</span> &amp;&amp;(!r || rand() &amp; <span class="number">1</span>)) r = i;</span><br><span class="line">        <span class="keyword">if</span> (!r) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;++i) <span class="keyword">if</span>(a[r][i] &gt; <span class="number">0</span> &amp;&amp; (!c || rand() &amp; <span class="number">1</span>)) c = i;</span><br><span class="line">        <span class="keyword">if</span> (!c) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        pivot(r, c);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>true</code>代表初始化成功，否则代表初始化失败，线性规划无解</p>
<h2 id="最终解"><a href="#最终解" class="headerlink" title="最终解"></a>最终解</h2><p>如果要求求出每个变量的值，那么我们可以开个数组存一下每个变量被转到哪里去了</p>
<p>如果这个变量变成了一个基变量，那么它的值等于约束右边的$b$</p>
<p>否则这个变量就是$0$</p>
<h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2><p>最坏情况下的时间复杂度是指数级别的</p>
<p>但是我们有信仰，随机情况下还是很优秀的</p>
<p>大部分时可以过$n,m=100-500$的数据</p>
<h1 id="将问题表示为线性规划"><a href="#将问题表示为线性规划" class="headerlink" title="将问题表示为线性规划"></a>将问题表示为线性规划</h1><h2 id="某个题"><a href="#某个题" class="headerlink" title="某个题"></a>某个题</h2><p>$A,B$两个人在洞中发现了$n$个石头，第$i$个石头对于$A$来说价值为$A_i$，对于$B$来说价值为$B_i$，石头是可以切割的，并且价值与其体积成正比。现在$A,B$要分配这些石头，要求它们两个人最终得到的价值相同，问这个价值最大可以是多少</p>
<p>$n\leq 50, 0\leq A_i,B_i\leq 100$</p>
<p>对于每块石头我们开一个变量$x_i$，表示这块石头有多少分给了$A$，显然有$0\leq x_i\leq 1$</p>
<p>那么两个人得到的价值之和分别为</p>
<script type="math/tex; mode=display">
\begin{gathered}
V_A=\sum_{i=1}^nx_iA_i\\
V_B=\sum_{i=1}^n(1-x_i)B_i
\end{gathered}</script><p>约束为$V_A=V_B$，要求最大化$V_A$</p>
<p>这里我们可以使用一个小技巧，即将约束改为$V_A\leq V_B$，最大化$V_A$，可以发现这是与原来的约束完全等价的</p>
<p>因为假如有一个解满足$V_A\ne V_B$，那么我们一定可以通过将某个变量$x$调大的方式使得$V_A$变得更大，那么这个解一定不是最优解</p>
<p>因此约束为</p>
<script type="math/tex; mode=display">
\begin{gathered}
V_A\leq V_B\Rightarrow \sum_{i=1}^nx_iA_i\leq \sum_{i=1}^n(1-x_i)B_i\\
\sum_{i=1}^nx_i(A_i+B_i)\leq\sum_{i=1}^nB_i
\end{gathered}</script><p>注意到$\sum B_i\geq 0$，因此不需要运行初始化，直接求解即可</p>
<h2 id="最大流问题"><a href="#最大流问题" class="headerlink" title="最大流问题"></a>最大流问题</h2><p>在原来的最大流问题中，除了源点、汇点外的每个点必须满足流入流量等于流出流量</p>
<p>我们新建一条从汇点连向源点，并且权值为$\infty$的边。</p>
<p>那么最终这条边的流量也就是源点到汇点的流量</p>
<p>用$f(u,v)$表示一条边的实际流量，$c(u,v)$表示一条边的流量，那么可以得到如下的线性规划</p>
<p>最大化</p>
<script type="math/tex; mode=display">
f(t,s)</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
f(u,v)\leq c(u,v) \quad\quad (u,v)\in E\\
\sum_vf(u,v)=\sum_vf(v,u)\quad \quad u\in V\\
f(u,v)\geq 0\quad\quad (u,v)\in E\cup|(t,s)|
\end{gathered}</script><h2 id="最小费用流问题"><a href="#最小费用流问题" class="headerlink" title="最小费用流问题"></a>最小费用流问题</h2><p>此时就不需要在汇点和源点之间新建边了</p>
<p>我们用$w(u,v)$代表一条边的费用，那么可以得出如下线性规划</p>
<p>最小化</p>
<script type="math/tex; mode=display">
\sum f(u,v)w(u,v)\quad\quad (u,v)\in E</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
\sum_vf(u,v)=\sum_{v}f(v,u)\quad \quad(u,v)\in E,v\not= s,t\\
f(u,v)\leq c(u,v)\quad\quad (u,v)\in E\\
f(u,v)\geq 0\quad\quad(u,v)\in E
\end{gathered}</script><h1 id="对偶问题"><a href="#对偶问题" class="headerlink" title="对偶问题"></a>对偶问题</h1><p>我们考虑这样一个线性规划</p>
<p>最<strong>小</strong>化</p>
<script type="math/tex; mode=display">
7x_1+x_2+5x_3</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
x_1-x_2+3x_3\geq 10\\
5x_1+2x_2-x_3\geq 6\\
x_{1,2,3}\geq 0
\end{gathered}</script><p>普通线性规划要求最大化，而这里要求最小化</p>
<p>普通线性规划的约束是小于等于，而这里是大于等于</p>
<p>我们当然可以选择将约束左右两边同时乘以$-1$，但是这样就需要初始化</p>
<p>这里有另一种方法——转对偶问题</p>
<p>由于$x_{1,2,3}\geq 0$，我们知道$7x_1+x_2+5x_3\geq x_1-x_2+3x_3\geq 10$</p>
<p>那么我们就知道了最终答案的一个下界，能不能找到一个更紧的下界呢？</p>
<p>能，比如</p>
<script type="math/tex; mode=display">
7x_1+x_2+5x_3\geq(x_1-x_2+3x_3)+(5x_1+2x_2-x_3)=10+6</script><p>于是我们有了一个奇妙的想法</p>
<p>对于每一个约束我们单独开一个变量，对于第$i$个约束的变量为$y_i$</p>
<p>我们用$y$来表示在最终的下界中，每个约束所乘的系数</p>
<p>比如上面的那个就可以表示为</p>
<script type="math/tex; mode=display">
y_1(x_1-x_2+3x_3)+y_2(5x_1+2x_2-x_3)</script><p>我们需要保证，对于每个变量$x_i$，通过这种方式表示出来的系数不超过估价函数中$x_i$的系数，否则我们就无法保证求出的是下界</p>
<p>同时我们需要最大化下界</p>
<p>那么我们可以得出如下的线性规划</p>
<p>最大化</p>
<script type="math/tex; mode=display">
10y_1+6y_2</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
y_1+5y_2\leq 7\\
-y_1+2y_2\leq 1\\
3y_1-y_2\leq 5\\
y_{1,2}\geq 0
\end{gathered}</script><p>求解这个线性规划，我们就能得到原估价函数的下界</p>
<p>我们将新得到的线性规划为对偶问题，如果对这个对偶问题再次进行对偶操作，那么我们会得到原问题</p>
<p>一个最大化问题可以对偶成最小化问题，同样一个最小化问题可以对偶成最大化问题</p>
<hr>
<p>下面给出对偶线性规划的定义</p>
<p>对于原式线性规划</p>
<p>最小化</p>
<script type="math/tex; mode=display">
\sum_{i=1}^nc_ix_i</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
\sum_{j=1}^na_{i,j}x_j\geq b_j\quad\quad i=1,2,\cdots, m\\
x_i\geq 0\quad\quad i=1,2,\cdots,m
\end{gathered}</script><p>它的对偶问题为</p>
<p>最大化</p>
<script type="math/tex; mode=display">
\sum_{i=1}^mb_iy_i</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
\sum_{j=1}^ma_{ij}y_j\leq c_i\quad\quad i=1,2,\cdots,n\\
y_i\geq 0\quad\quad i=1,2,\cdots n
\end{gathered}</script><p>用矩阵可以表示为</p>
<script type="math/tex; mode=display">
\begin{cases}
最大化\ c^Tx\\
满足约束\ Ax\geq b,x\geq 0
\end{cases}
\longleftrightarrow
\begin{cases}
最大化\ b^Ty\\
满足约束\ A^Ty\leq c,y\geq 0
\end{cases}</script><p>同样，$A^T$表示矩形转置</p>
<h1 id="几个重要定理"><a href="#几个重要定理" class="headerlink" title="几个重要定理"></a>几个重要定理</h1><h2 id="定理1-线性规划弱对偶性"><a href="#定理1-线性规划弱对偶性" class="headerlink" title="定理1. 线性规划弱对偶性"></a>定理1. 线性规划弱对偶性</h2><blockquote>
<p>若$X=(x_1,x_2,\cdots,x_n)$是原问题的一个可行解，$Y=(y_1,y_2,\cdots,y_m)$是对偶问题的一个可行解，那么</p>
<script type="math/tex; mode=display">
\sum_{i=1}^mb_iy_i\leq\sum_{j=1}^nc_jx_j</script></blockquote>
<p><del>其实我觉得挺显然的</del></p>
<p>证明：</p>
<p>由于$Y$是对偶问题的一个可行解，所以</p>
<script type="math/tex; mode=display">
c_j\geq\sum_{i=1}^ma_{ij}y_i</script><p>由于有$x_i\geq 0$，所以</p>
<script type="math/tex; mode=display">
\sum_{j=1}^nc_jx_j\geq\sum_{j=1}^n(\sum_{i=1}^ma_{ij}y_i)x_j</script><p>由于$X$是原问题的一个可行解，所以</p>
<script type="math/tex; mode=display">
b_j\leq\sum_{i=1}^na_{ji}x_i</script><p>由于有$y_i\geq 0$，所以</p>
<script type="math/tex; mode=display">
\sum_{i=1}^m(\sum_{j=1}^na_{ij}x_j)y_i\geq \sum_{i=1}^mb_iy_i</script><p>我们知道</p>
<script type="math/tex; mode=display">
\sum_{j=1}^n(\sum_{i=1}^ma_{ij}y_i)x_j=\sum_{i=1}^m(\sum_{j=1}^na_{ij}x_j)y_i</script><p>所以结论成立</p>
<h2 id="定理2-线性规划对偶性"><a href="#定理2-线性规划对偶性" class="headerlink" title="定理2. 线性规划对偶性"></a>定理2. 线性规划对偶性</h2><blockquote>
<p>若$X^{\times }=(x_1,x_2,\cdots,x_n)$是原问题的最优解，$Y^{\times }=(y_1,y_2,\cdots,y_m)$是对偶问题的最优解，那么</p>
<script type="math/tex; mode=display">
\sum_{i=1}^mb_iy_i=\sum_{j=1}^nc_jx_j</script></blockquote>
<p><strong>引理</strong>： 设$I$是一个下标集合，对于每一个$j\in I$，设$\alpha_j,\beta_j$是实数，并令$x_j$是一个实数变量，设$\gamma$是任意的实数。假设对于变量$x_j$的任意设置，我们有</p>
<script type="math/tex; mode=display">
\sum_{j\in I}\alpha_jx_j=\gamma+\sum_{j\in I}\beta_jx_j</script><p>那么对于任意的$j\in I,\alpha_j=\beta_j$，且$\gamma=0$</p>
<p><strong>证明</strong>：因为上式对于任意的$x_j$都成立，那么我们可以通过代入一些特殊值的方式求出$\gamma,\alpha,\beta$。比如令所有的$x$都为$0$，那么我们可以得到$\gamma=0$，对于$j$，我们令$x_j=1,x_k=0(k\ne j)$，那么我们可以得出$\alpha_j=\beta_j$</p>
<p>注意这里使用的特殊值仍然满足$x_j\geq 0$</p>
<hr>
<p>为了证明这个定理，我们先尝试构造一组对偶问题的解</p>
<p>定义$N$表示非基变量，$B$表示基变量</p>
<p>我们假设原问题在经过松弛过后得到的结果为</p>
<p>最大化</p>
<script type="math/tex; mode=display">
v'+\sum_{j\in N}c'_jx_j</script><p>满足约束</p>
<script type="math/tex; mode=display">
x_i=b'_i-\sum_{j\in N}a'_{ij}x_j\quad\quad i\in B</script><p>我们令</p>
<script type="math/tex; mode=display">
\bar y_i=\begin{cases}
-c'_{n+i}&若(n+i)\in N\\
0 &其它
\end{cases}</script><p>其实就是在原问题求解完毕后，在估价函数中所有非基变量的系数取反</p>
<p>现在我们开始证明</p>
<p>定义$\bar x=(\bar x_1,\bar x_2,\cdots,\bar x_n)$为原问题的最优解，$\bar y$为按照上面的方式取得的对偶问题的解</p>
<p>在最终形态的线性规划中，原问题的估价函数为</p>
<script type="math/tex; mode=display">
z=v'+\sum_{j\in N}c'_j\bar x_j</script><p>对于$j\in B$，我们定义$c’_j=0$</p>
<p>所以</p>
<script type="math/tex; mode=display">
\begin{aligned}
z&=v'+\sum_{j\in N}c'_j\bar x_j+\sum_{j\in B}c'_j\bar x_j\\
&=v'+\sum_{i=1}^{n+m}c'_j\bar x_j
\end{aligned}</script><p>对于$j\in N$，我们知道$\bar x_j=0$，如果我们将此时的解代入原问题求估价函数，那么会得到同样的结果。所以</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{j=1}^nc_j\bar x_j&=v'+\sum_{j=1}^{n+m}c'_j\bar x_j\\
&=v'+\sum_{j\in N}c'_j\bar x_j+\sum_{j\in B}c'_j\bar x_j\\
&=v'+\sum_{j\in N}(c'_j\times 0)+\sum_{j\in B}(0\times \bar x_j)\\
&=v'
\end{aligned}</script><p>现在我们要说明之前构造出来的$\bar y$对于对偶线性规划是可行的，并且其估价函数的值$\sum\limits_{i=1}^mb_iy_i$等于$\sum\limits_{j=1}^n c_j\bar x_j$。我们刚刚证明了原问题（第一个松弛型）与最终问题（最后一个松弛型）代入$\bar x$求值是相等的。更一般地，所有松弛型都是等价的意味着对于任意变量集合$x=(x_1,x_2,\cdots,x_n)$，我们有</p>
<script type="math/tex; mode=display">
\sum_{j=1}^nc_jx_j=v'+\sum_{j=1}^{n+m}c'_jx_j</script><p>因此，对于任意的特定值集合$\bar x=(\bar x_1,\bar x_2,\cdots, \bar x_n)$，有</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{j=1}^nc_j\bar x_j&=v'+\sum_{j=1}^{n+m}c'_j\bar x_j=v'+\sum_{j=1}^nc'_j\bar x_j+\sum_{j=1}^mc'_{j+n}\bar x_{j+n}\\
&=v'+\sum_{j=1}^nc'_j\bar x_j+\sum_{i=1}^m(-\bar y_i)\bar x_{n+i}\\
&=v'+\sum_{j=1}^nc'_j\bar x_j+\sum_{i=1}^m(-\bar y_i)(b_i-\sum_{j=1}^na_{ij}\bar x_j)
\end{aligned}</script><p>注意，原问题的对偶问题和原问题经过变换后的对偶问题是等价的</p>
<p>对于原问题的一次变换，其实就是转轴操作，我们可以认为在对偶问题中，我们同步进行了一次转轴操作，最终得到的仍然是对偶问题</p>
<p>所以这里的$b,a$我们改成$b’,a’$仍然是可以的</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{j=1}^nc_j\bar x_j&=v'+\sum_{j=1}^nc'_j\bar x_j-\sum_{i=1}^mb_i\bar y_i+\sum_{i=1}^m\bar y_i\sum_{j=1}^na_{ij}\bar x_j\\
&=v'+\sum_{j=1}^nc'_j\bar x_j-\sum_{i=1}^mb_i\bar y_i+\sum_{j=1}^n\bar x_j\sum_{i=1}^ma_{ij}\bar y_i\\
&=(v'-\sum_{i=1}^mb_i\bar y_i)+\sum_{j=1}^n(c'_j+\sum_{i=1}^ma_{ij}\bar y_i)\bar x_j
\end{aligned}</script><p>根据引理，我们可以得到</p>
<script type="math/tex; mode=display">
\begin{gathered}
v'-\sum_{i=1}^mb_i\bar y_i=0\\
c'_j+\sum_{i=1}^ma_{ij}\bar y_i=c_j
\end{gathered}</script><p>因此，对偶问题的估价函数值与原问题相等，下面我们来说明$\bar y$为对偶问题的可行解</p>
<p>对于基变量，我们知道$c’=0$</p>
<p>对于非基变量，我们知道$c’\leq 0$，否则我们可以继续进行松弛操作，使得估价函数的值更加优秀</p>
<p>因此$c’_j\leq 0,\sum\limits_{i=1}^ma_{ij}\bar y_i\leq c_j$</p>
<p>满足对偶问题的约束</p>
<p>因此我们证明了定理2，同时给出了构造对偶问题最优解的一种方法</p>
<h2 id="定理3-互松弛定理"><a href="#定理3-互松弛定理" class="headerlink" title="定理3. 互松弛定理"></a>定理3. 互松弛定理</h2><blockquote>
<p>若$X=(x_1,x_2,\cdots,x_n),Y=(y_1,y_2,\cdots,y_n)$分别是原问题及对偶问题的一组可行解，那么$X,Y$都是最优解当且仅当</p>
<script type="math/tex; mode=display">
\begin{gathered}
对于所有的1\leq j\leq n,满足x_j=0或\sum_{i=1}^ma_{ij}y_i=c_j\\
对于所有的1\leq i\leq m,满足y_i=0或\sum_{j=1}^na_{ij}x_j=b_i
\end{gathered}</script></blockquote>
<p>证明：根据定理2证明中的最后一步</p>
<script type="math/tex; mode=display">
c'_j+\sum_{i=1}^ma_{ij}\bar y_i=c_j</script><p>我们分类讨论：</p>
<ol>
<li>$c’_j=0$</li>
</ol>
<p>此时也就是$x_j$的系数为$0$，那么$x_j$随意即可，对最终的结果不会造成影响</p>
<ol>
<li>$c’_j&lt; 0$</li>
</ol>
<p>此时为了要求最终结果最大，必然有$x_j=0$，否则我们可以通过减少$x_j$的值使得结果变大</p>
<p>对于$y$的证明同理</p>
<h1 id="对偶的应用"><a href="#对偶的应用" class="headerlink" title="对偶的应用"></a>对偶的应用</h1><h2 id="偷懒"><a href="#偷懒" class="headerlink" title="偷懒"></a>偷懒</h2><p>给一张$n$个点的带权无向图，边$u,v$的权值为$w_{u,v}$，可以随意增加或者减少一条边的边权，代价为边权的变化量。要求进行操作之后任意两点间直接相连的边的长度不超过两点之间的最短路，求最小代价</p>
<p>$n\leq 10,w\leq 20$</p>
<p>对于每一条边我们开两个变量$t_{u,v},t’_{u,v}$，表示这条边增加了多少/减少了多少</p>
<p>那么对于一条边$u,v$，经过操作之后它的边权为$w_{u,v}+t_{u,v}-t’_{u,v}$，令$d_{u,v}$表示操作之后$u,v$两点间的最短路长度</p>
<p>我们可以得到如下线性规划</p>
<p>最小化</p>
<script type="math/tex; mode=display">
\sum_{(u,v)\in E}t_{u,v}+t'_{u,v}</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
d_{u,v}\geq w_{u,v}+t_{u,v}-t'_{u,v}\quad\quad (u,v)\in E\\
-d_{u,v}\geq -w_{u,v}-t_{u,v}+t'_{u,v}\quad\quad (u,v)\in E\\
w_{u,i}+t_{u,i}-t'_{u,i}\geq d_{u,v}-d_{u,i}\quad\quad u\ne v,(u,i)\in E\\
\end{gathered}
d,t,t'\geq 0</script><p>注意到之间求解需要初始化，而目标函数中的系数都是正的</p>
<p>所以我们可以将这个线性规划进行对偶，将所有的$b$都变成正数，这样就不需要初始化了</p>
<h2 id="将线性规划转化为半平面交"><a href="#将线性规划转化为半平面交" class="headerlink" title="将线性规划转化为半平面交"></a>将线性规划转化为半平面交</h2><p>给出三个长度为$n$的数组$a_i,b_i,c_i$，每次询问给出两个数$s,t$，求一组非负实数$x_i$，满足</p>
<script type="math/tex; mode=display">
\sum_{i=1}^na_ix_i=s,\sum_{i=1}^nb_ix_i=t</script><p>同时最大化$\sum\limits_{i=1}^nc_ix_i$，对于每组询问输出最大值或无解</p>
<p>$n\leq 10^5,a,b,c,s,t,m\leq 10^4$</p>
<p>注意到每次变化的是限制，而对于目标函数是不变的，这意味着转对偶之后限制是不变的</p>
<p>那么对初始线性规划我们转一个对偶，然后未知数就变成了两个，限制变成了$n$个，并且是固定的</p>
<p>此时目标函数变成了$sy_1+ty_2$</p>
<p>由于初始线性规划的约束是等于，所以转对偶之后对于$y_1,y_2$是否大于$0$没有限制</p>
<p>这里简单说明一下</p>
<p>我们考虑一个这样的线性规划</p>
<p>约束为</p>
<script type="math/tex; mode=display">
\sum_{j=1}^na_{ij}x_i=b_i</script><p>我们可以把它拆成两个</p>
<script type="math/tex; mode=display">
\begin{gathered}
\sum_{j=1}^na_{ij}x_i\geq b_i\\
-\sum_{j=1}^na_{ij}x_i\geq -b_i
\end{gathered}</script><p>现在考虑对偶，我们设第一个限制的未知数为$y_1$，第二个为$y_2$</p>
<p>那么对偶的限制一定是对$y_1-y_2$的限制</p>
<p>现在我们将$y_1,y_2$合成一个变量，虽然有$y_1\geq 0,y_2\geq 0$，但是这个新合成的变量$y_1-y_2$却可以小于$0$</p>
<p>所以此时对偶之后的变量才没有$\geq 0$的限制</p>
<p>将$y_1$看作$x$，将$y_2$看作$y$，我们可以把约束转化为半平面交的形式</p>
<p>所以询问的时候直接在凸壳上二分即可</p>
<h2 id="将线性规划转化为网络流"><a href="#将线性规划转化为网络流" class="headerlink" title="将线性规划转化为网络流"></a>将线性规划转化为网络流</h2><p>给出一个带权的连通无向图，有$n$个点$m$条边，对于每条边，增加$1$的权值需要花费$a_i$，减少$1$的权值需要花费$b_i$，给定一棵生成树，需要通过修改边权使得它成为最小生成树，求最小花费</p>
<p>考虑一条边为非树边的含义是什么</p>
<p>如果一条原图上的边$u,v$不在最小生成树上，那么在生成树上它覆盖的所有边的权值都不能小于它</p>
<p>并且树边一定不会加，非树边一定不会减</p>
<p>写成线性规划的形式就是</p>
<p>最小化</p>
<script type="math/tex; mode=display">
\sum_{i\in T}b_ix_i+\sum_{i\in E-T}a_ix_i</script><p>满足约束</p>
<script type="math/tex; mode=display">
\begin{gathered}
x_i+x_j\geq w_i-w_j\quad\quad i被j覆盖\\
x_i\geq 0
\end{gathered}</script><p>首先来转一个对偶</p>
<p>最大化</p>
<script type="math/tex; mode=display">
\sum_{i\in T,j\in E-T,j覆盖i}(w_i-w_j)y_{ij}</script><p>满足约束</p>
<script type="math/tex; mode=display">
\sum_{j\in E-T,j覆盖i}y_{ij}\leq b_i\quad\quad i\in T\\
\sum_{i\in T,j覆盖i} y_{ij}\leq a_i\quad\quad j\in E-T</script><p>我们将$T$中的边放在左边，$E-T$中的边放在右边，可以看出这是一个最大费用流模型，其中$y_{ij}$就是流量</p>
<p>需要满足对于$T$中的点，每个点的流量不超过$b_i$，对于$E-T$中的点，每个点的流量不超过$a_i$</p>
<p>如果$j$覆盖$i$，那么我们从$i$向$j$连一条容量无限，费用为$w_i-w_j$的边</p>
<p>然后在这张图上跑一遍费用流就可以了</p>
<p>注意这里的费用流不是优先满足最大流，而是优先满足费用最大</p>
<p><code>dinic</code>的时候如果当前费用小于上次更新时的费用就<code>break</code></p>
<hr>
<p>完结撒花</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" rel="tag"># 网络流</a>
              <a href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" rel="tag"># 计算几何</a>
              <a href="/tags/%E5%8D%8A%E5%B9%B3%E9%9D%A2%E4%BA%A4/" rel="tag"># 半平面交</a>
              <a href="/tags/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/" rel="tag"># 线性规划</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/04/25/4-24%E7%9C%81%E9%80%89%E6%A8%A1%E6%8B%9F/" rel="prev" title="4.24省选模拟">
      <i class="fa fa-chevron-left"></i> 4.24省选模拟
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/05/05/5-4%E7%9C%81%E9%80%89%E6%A8%A1%E6%8B%9F/" rel="next" title="5.4省选模拟">
      5.4省选模拟 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#什么是线性规划"><span class="nav-number">1.</span> <span class="nav-text">什么是线性规划</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一些定义"><span class="nav-number">2.</span> <span class="nav-text">一些定义</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#标准型线性规划"><span class="nav-number">3.</span> <span class="nav-text">标准型线性规划</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#松弛型线性规划"><span class="nav-number">4.</span> <span class="nav-text">松弛型线性规划</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#单纯形"><span class="nav-number">5.</span> <span class="nav-text">单纯形</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#转轴操作"><span class="nav-number">5.1.</span> <span class="nav-text">转轴操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#初始化"><span class="nav-number">5.2.</span> <span class="nav-text">初始化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最终解"><span class="nav-number">5.3.</span> <span class="nav-text">最终解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#时间复杂度"><span class="nav-number">5.4.</span> <span class="nav-text">时间复杂度</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#将问题表示为线性规划"><span class="nav-number">6.</span> <span class="nav-text">将问题表示为线性规划</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#某个题"><span class="nav-number">6.1.</span> <span class="nav-text">某个题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最大流问题"><span class="nav-number">6.2.</span> <span class="nav-text">最大流问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最小费用流问题"><span class="nav-number">6.3.</span> <span class="nav-text">最小费用流问题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#对偶问题"><span class="nav-number">7.</span> <span class="nav-text">对偶问题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#几个重要定理"><span class="nav-number">8.</span> <span class="nav-text">几个重要定理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#定理1-线性规划弱对偶性"><span class="nav-number">8.1.</span> <span class="nav-text">定理1. 线性规划弱对偶性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#定理2-线性规划对偶性"><span class="nav-number">8.2.</span> <span class="nav-text">定理2. 线性规划对偶性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#定理3-互松弛定理"><span class="nav-number">8.3.</span> <span class="nav-text">定理3. 互松弛定理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#对偶的应用"><span class="nav-number">9.</span> <span class="nav-text">对偶的应用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#偷懒"><span class="nav-number">9.1.</span> <span class="nav-text">偷懒</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将线性规划转化为半平面交"><span class="nav-number">9.2.</span> <span class="nav-text">将线性规划转化为半平面交</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将线性规划转化为网络流"><span class="nav-number">9.3.</span> <span class="nav-text">将线性规划转化为网络流</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="PlanarG"
      src="/images/77041874_p0_master12001.jpg">
  <p class="site-author-name" itemprop="name">PlanarG</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">185</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://planarg.top/" title="https:&#x2F;&#x2F;planarg.top&#x2F;">Title</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">PlanarG</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1.5,"jsonPath":"/live2dw/assets/histoire.model.json"},"display":{"position":"left","width":150,"height":300,"hOffset":35,"vOffset":-25},"mobile":{"show":false},"log":false});</script></body>
</html>
